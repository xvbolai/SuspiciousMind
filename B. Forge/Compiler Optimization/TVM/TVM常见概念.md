### Relay Lowing Tir

在TVM中，从高级计算图（如Relay计算图）到低级计算图（如TIR计算图）的转换过程通常称为“下降”（lowering）过程。这个过程中，TVM会将高级计算图逐步转换为更低级别的计算图，直到最终转换为特定硬件的低级代码。

在这个下降的过程中，算子融合通常是在转换为低级计算图（如TIR计算图）之前进行的。具体来说，在Relay前端中进行算子融合的步骤通常是在下降的过程中进行的，即在将高级计算图（Relay计算图）转换为低级计算图（TIR计算图）的过程中进行。

下降的过程通常包括以下几个步骤：

1. Relay前端处理。在这个步骤中，Relay前端会将用户定义的神经网络模型转换为一个由Relay中的算子和数据结构组成的计算图。
    
2. Relay后端处理。在这个步骤中，Relay后端会对Relay计算图进行一系列的优化和转换，如算子融合、常量折叠、死代码删除等等。这些优化的目的是尽可能地减少计算图中的冗余计算和数据传输，并生成一个更高效的计算图。
    
3. TIR转换。在这个步骤中，TVM会将优化后的Relay计算图转换为TIR计算图，并进行一系列的TIR优化，如算子融合、内存优化、并行化等等。
    
4. 代码生成。在这个步骤中，TVM会将TIR计算图转换为特定硬件的低级代码，并进行一系列的代码优化，如循环优化、向量化等等。这些优化的目的是生成高效的本地代码，以提高程序的性能和效率。
    

因此，在下降的过程中，算子融合通常是在TIR转换之前进行的，即在将高级计算图（如Relay计算图）转换为低级计算图（如TIR计算图）的过程中进行的。在Relay前端中进行算子融合的步骤通常是在下降的过程中进行的，即在将高级计算图（Relay计算图）转换为低级计算图（TIR计算图）的过程中进行。这样可以在生成TIR计算图之前，尽可能地减少计算图中的冗余计算和数据传输，并生成一个更高效的计算图。

### AutoScheduler 优化阶段

TVM在将TE降级为TIR的过程中，可以采用AutoScheduler来探索最优的调度策略，以实现高效的代码生成和优化。具体来说，TVM将TE表达式转换为TIR的过程，可以分为两个阶段：

1. TIR构建阶段。在这个阶段中，TVM将TE表达式转换为TIR表达式，并构建出TIR的计算图。这个阶段不涉及调度和代码生成，只是将TE表达式转换为TIR表达式。
    
2. TIR优化阶段。在这个阶段中，TVM将对TIR进行一系列的优化，如算子融合、内存优化、并行化等等。在这个阶段中，可以采用AutoScheduler来探索最优的调度策略，以实现高效的代码生成和优化。
    

因此，AutoScheduler通常是在TIR优化阶段中使用的，用于探索最优的调度策略，以实现高效的代码生成和优化。在TIR构建阶段中，不需要使用AutoScheduler，因为这个阶段只是将TE表达式转换为TIR表达式，并构建出TIR的计算图，不涉及调度和代码生成。

总之，TVM在将TE降级为TIR的过程中，可以采用AutoScheduler来探索最优的调度策略，以实现高效的代码生成和优化。AutoScheduler通常是在TIR优化阶段中使用的，用于探索最优的调度策略，以实现高效的代码生成和优化。在TIR构建阶段中，不需要使用AutoScheduler。